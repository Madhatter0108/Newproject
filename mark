this code is from Github from mark
